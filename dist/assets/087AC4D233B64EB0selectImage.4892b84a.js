/*! 
 Build based on gin-vue-admin 
 Time : 1725432472000 */
import{ad as e,o as l,c as a,G as t,h as o,w as s,d as r,e as u,b as i,cF as n,g as c,d0 as m,J as d,dd as p,a as v,cZ as f,V as g,O as y,P as h,de as B,t as C,au as w,j as x,l as k,E as j}from"./087AC4D233B64EB0index.70d09b05.js";/* empty css                               *//* empty css                                *//* empty css                                   *//* empty css                            *//* empty css                               *//* empty css                                  *//* empty css                               *//* empty css                                     *//* empty css                               *//* empty css                              */import{b,g as E}from"./087AC4D233B64EB0image.381f4010.js";import{_ as D,U as A,e as _,g as V,d as z}from"./087AC4D233B64EB0common.27d965e2.js";import{_ as I}from"./087AC4D233B64EB0warningBar.fba111b1.js";import{E as S}from"./087AC4D233B64EB0index.445cc723.js";import{E as T}from"./087AC4D233B64EB0index.7d3772ac.js";import{E as U}from"./087AC4D233B64EB0index.cf7c943f.js";const P={class:"w-40 h-40 relative rounded border border-dashed border-gray-300 overflow-hidden cursor-pointer group"},O={key:1,class:"w-full h-full object-cover",muted:"",preload:"metadata"},F=["src"],M=["src"],Z={__name:"selectComponent",props:{model:{default:"",type:String}},emits:["chooseItem","deleteItem"],setup(p,{emit:v}){const f=v,g=()=>{f("chooseItem")},y=()=>{f("deleteItem")};return(v,f)=>{const h=e("VideoPlay"),B=d;return l(),a("div",P,[t(b)(p.model||"")?(l(),o(B,{key:0,size:32,class:"absolute top-[calc(50%-16px)] left-[calc(50%-16px)]"},{default:s((()=>[r(h)])),_:1})):u("",!0),t(b)(p.model||"")?(l(),a("video",O,[i("source",{src:t(E)(p.model)+"#t=1"},null,8,F)])):u("",!0),p.model&&!t(b)(p.model)?(l(),a("img",{key:2,class:"w-full h-full",src:t(E)(p.model),alt:"图片"},null,8,M)):u("",!0),p.model?(l(),a("div",{key:3,class:"left-0 top-0 hidden text-gray-600 group-hover:bg-gray-600 group-hover:bg-opacity-30 w-full h-full group-hover:flex justify-center items-center absolute z-10",onClick:y},[r(B,null,{default:s((()=>[r(t(n))])),_:1}),c(" 删除 ")])):(l(),a("div",{key:4,class:"text-gray-600 group-hover:bg-gray-400 w-full h-full flex justify-center items-center",onClick:g},[r(B,null,{default:s((()=>[r(t(m))])),_:1}),c(" 上传 ")]))])}}},G={key:1,class:"w-full gap-4 flex flex-wrap"},J={class:"gva-btn-list gap-2"},N={class:"flex flex-wrap gap-4"},Q={class:"w-40 h-40 border rounded overflow-hidden border-dashed border-gray-300 cursor-pointer relative group"},R=["onClick"],W=["src"],q={key:2,class:"w-full h-full object-cover flex items-center justify-center"},H=["onClick"],K=["onClick"],L={__name:"selectImage",props:p({multiple:{type:Boolean,default:!1},fileType:{type:String,default:""},maxUpdateCount:{type:Number,default:0}},{modelValue:{type:[String,Array]},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const m=v(""),p=v(""),P=v({}),O=v(1),F=v(0),M=v(20),L=f(n,"modelValue"),X=n,Y=v([]);g((()=>{X.multiple&&(Y.value=L.value)}));const $=e=>{M.value=e,re()},ee=e=>{O.value=e,re()},le=v(!1),ae=v([]),te={image:["png","jpg","jpeg","gif","bmp","webp"],video:["mp4","avi","rmvb","rm","asf","divx","mpg","mpeg","mpe","wmv","mkv","vob"]},oe=e=>{if(X.fileType){if(!te[X.fileType].some((l=>{if(e.includes(l))return!0})))return void x({type:"error",message:"当前类型不支持使用"})}X.multiple?(Y.value.push(e),L.value=Y.value):L.value=e,le.value=!1},se=async()=>{!L.value||X.multiple?(await re(),le.value=!0):L.value=""},re=async()=>{const e=await V({page:O.value,pageSize:M.value,...P.value});0===e.code&&(ae.value=e.data.list,F.value=e.data.total,O.value=e.data.page,M.value=e.data.pageSize)};return(v,f)=>{const g=k,V=j,X=e("VideoPlay"),te=d,ue=S,ie=e("CircleClose"),ne=T,ce=U;return l(),a("div",null,[n.multiple?(l(),a("div",G,[(l(!0),a(y,null,h(Y.value,((e,a)=>(l(),o(Z,{key:a,model:e,onChooseItem:se,onDeleteItem:e=>(e=>{Y.value.splice(e,1),L.value=Y.value})(a)},null,8,["model","onDeleteItem"])))),128)),Y.value.length<n.maxUpdateCount||0===n.maxUpdateCount?(l(),o(Z,{key:0,onChooseItem:se,onDeleteItem:se})):u("",!0)])):(l(),o(Z,{key:0,model:L.value,onChooseItem:se,onDeleteItem:se},null,8,["model"])),r(ce,{modelValue:le.value,"onUpdate:modelValue":f[1]||(f[1]=e=>le.value=e),title:"媒体库",size:"650px"},{default:s((()=>[r(I,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),i("div",J,[r(D,{"image-common":p.value,onOnSuccess:re},null,8,["image-common"]),r(A,{"image-url":m.value,"file-size":512,"max-w-h":1080,onOnSuccess:re},null,8,["image-url"]),r(g,{modelValue:P.value.keyword,"onUpdate:modelValue":f[0]||(f[0]=e=>P.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"]),r(V,{type:"primary",icon:"search",onClick:re},{default:s((()=>[c(" 查询 ")])),_:1})]),i("div",N,[(l(!0),a(y,null,h(ae.value,((e,n)=>(l(),a("div",{key:n,class:"w-40"},[i("div",Q,[(l(),o(ue,{key:n,src:t(E)(e.url),fit:"cover",class:"w-full h-full relative",onClick:l=>oe(e.url)},{error:s((()=>[t(b)(e.url||"")?(l(),o(te,{key:0,size:32,class:"absolute top-[calc(50%-16px)] left-[calc(50%-16px)]"},{default:s((()=>[r(X)])),_:1})):u("",!0),t(b)(e.url||"")?(l(),a("video",{key:1,class:"w-full h-full object-cover",muted:"",preload:"metadata",onClick:l=>oe(e.url)},[i("source",{src:t(E)(e.url)+"#t=1"},null,8,W),c(" 您的浏览器不支持视频播放 ")],8,R)):(l(),a("div",q,[r(te,{size:32},{default:s((()=>[r(t(B))])),_:1})]))])),_:2},1032,["src","onClick"])),i("div",{class:"absolute -right-1 top-1 w-8 h-8 group-hover:inline-block hidden",onClick:l=>(e=>{w.confirm("是否删除该文件","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await z(e)).code&&(x({type:"success",message:"删除成功!"}),re())})).catch((()=>{x({type:"info",message:"已取消删除"})}))})(e)},[r(te,{size:16},{default:s((()=>[r(ie)])),_:1})],8,H)]),i("div",{class:"overflow-hidden text-nowrap overflow-ellipsis text-center w-full",onClick:l=>(async e=>{w.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:l})=>{e.name=l,0===(await _(e)).code&&(x({type:"success",message:"编辑成功!"}),re())})).catch((()=>{x({type:"info",message:"取消修改"})}))})(e)},C(e.name),9,K)])))),128))]),r(ne,{"current-page":O.value,"page-size":M.value,total:F.value,style:{"justify-content":"center"},layout:"total, prev, pager, next, jumper",onCurrentChange:ee,onSizeChange:$},null,8,["current-page","page-size","total"])])),_:1},8,["modelValue"])])}}};export{L as _};
