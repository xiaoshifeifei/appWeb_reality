/*! 
 Build based on gin-vue-admin 
 Time : 1725432472000 */
import{C as e,ab as a,bY as t,a$ as l,az as r,aZ as n,bm as s,F as o,ac as d,T as i,x as c,S as u,a1 as f,y as h,r as p,dg as m,ag as g,o as v,c as k,b as y,d as C,w as b,g as x,t as B,G as V,ai as A,n as D,h as _,dQ as E,l as T,e as j,a2 as P,a5 as w,O as U,P as S,B as I,K as O,aR as q,a as M,aC as z,A as $,J as L,a4 as R,aa as F,E as N,a7 as Q,L as G,dC as H,au as J,j as K}from"./087AC4D233B64EB0index.70d09b05.js";import{E as Y}from"./087AC4D233B64EB0card.e1c6011c.js";/* empty css                               *//* empty css                              */import{E as Z,a as W}from"./087AC4D233B64EB0checkbox.946614c0.js";/* empty css                                       */import{_ as X}from"./087AC4D233B64EB0warningBar.fba111b1.js";import{n as ee,o as ae,q as te}from"./087AC4D233B64EB0autoCode.8131c587.js";import{j as le}from"./087AC4D233B64EB0api.081d701a.js";import"./087AC4D233B64EB0isEqual.754d772a.js";import"./087AC4D233B64EB0_Uint8Array.b8c6af2c.js";const re="left-check-change",ne="right-check-change",se=e({data:{type:a(Array),default:()=>[]},titles:{type:a(Array),default:()=>[]},buttonTexts:{type:a(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:a(Function)},leftDefaultChecked:{type:a(Array),default:()=>[]},rightDefaultChecked:{type:a(Array),default:()=>[]},renderContent:{type:a(Function)},modelValue:{type:a(Array),default:()=>[]},format:{type:a(Object),default:()=>({})},filterable:Boolean,props:{type:a(Object),default:()=>t({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),oe=(e,a)=>[e,a].every(r)||r(e)&&s(a),de={[l]:(e,a,t)=>[e,t].every(r)&&["left","right"].includes(a),[n]:e=>r(e),[re]:oe,[ne]:oe},ie="checked-change",ce=e({data:se.data,optionRender:{type:a(Function)},placeholder:String,title:String,filterable:Boolean,format:se.format,filterMethod:se.filterMethod,defaultChecked:se.leftDefaultChecked,props:se.props}),ue={[ie]:oe},fe=e=>{const a={label:"label",key:"key",disabled:"disabled"};return o((()=>({...a,...e.props})))},he=c({name:"ElTransferPanel"});var pe=O(c({...he,props:ce,emits:ue,setup(e,{expose:a,emit:t}){const l=e,r=u(),n=({option:e})=>e,{t:s}=f(),c=h("transfer"),O=p({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),q=fe(l),{filteredData:M,checkedSummary:z,isIndeterminate:$,handleAllCheckedChange:L}=((e,a,t)=>{const l=fe(e),r=o((()=>e.data.filter((t=>d(e.filterMethod)?e.filterMethod(a.query,t):String(t[l.value.label]||t[l.value.key]).toLowerCase().includes(a.query.toLowerCase()))))),n=o((()=>r.value.filter((e=>!e[l.value.disabled])))),s=o((()=>{const t=a.checked.length,l=e.data.length,{noChecked:r,hasChecked:n}=e.format;return r&&n?t>0?n.replace(/\${checked}/g,t.toString()).replace(/\${total}/g,l.toString()):r.replace(/\${total}/g,l.toString()):"".concat(t,"/").concat(l)})),c=o((()=>{const e=a.checked.length;return e>0&&e<n.value.length})),u=()=>{const e=n.value.map((e=>e[l.value.key]));a.allChecked=e.length>0&&e.every((e=>a.checked.includes(e)))};return i((()=>a.checked),((e,l)=>{if(u(),a.checkChangeByUser){const a=e.concat(l).filter((a=>!e.includes(a)||!l.includes(a)));t(ie,e,a)}else t(ie,e),a.checkChangeByUser=!0})),i(n,(()=>{u()})),i((()=>e.data),(()=>{const e=[],t=r.value.map((e=>e[l.value.key]));a.checked.forEach((a=>{t.includes(a)&&e.push(a)})),a.checkChangeByUser=!1,a.checked=e})),i((()=>e.defaultChecked),((e,t)=>{if(t&&e.length===t.length&&e.every((e=>t.includes(e))))return;const r=[],s=n.value.map((e=>e[l.value.key]));e.forEach((e=>{s.includes(e)&&r.push(e)})),a.checkChangeByUser=!1,a.checked=r}),{immediate:!0}),{filteredData:r,checkableData:n,checkedSummary:s,isIndeterminate:c,updateAllChecked:u,handleAllCheckedChange:e=>{a.checked=e?n.value.map((e=>e[l.value.key])):[]}}})(l,O,t),R=o((()=>!m(O.query)&&m(M.value))),F=o((()=>!m(r.default()[0].children))),{checked:N,allChecked:Q,query:G}=g(O);return a({query:G}),(e,a)=>(v(),k("div",{class:D(V(c).b("panel"))},[y("p",{class:D(V(c).be("panel","header"))},[C(V(Z),{modelValue:V(Q),"onUpdate:modelValue":e=>A(Q)?Q.value=e:null,indeterminate:V($),"validate-event":!1,onChange:V(L)},{default:b((()=>[x(B(e.title)+" ",1),y("span",null,B(V(z)),1)])),_:1},8,["modelValue","onUpdate:modelValue","indeterminate","onChange"])],2),y("div",{class:D([V(c).be("panel","body"),V(c).is("with-footer",V(F))])},[e.filterable?(v(),_(V(T),{key:0,modelValue:V(G),"onUpdate:modelValue":e=>A(G)?G.value=e:null,class:D(V(c).be("panel","filter")),size:"default",placeholder:e.placeholder,"prefix-icon":V(E),clearable:"","validate-event":!1},null,8,["modelValue","onUpdate:modelValue","class","placeholder","prefix-icon"])):j("v-if",!0),P(C(V(W),{modelValue:V(N),"onUpdate:modelValue":e=>A(N)?N.value=e:null,"validate-event":!1,class:D([V(c).is("filterable",e.filterable),V(c).be("panel","list")])},{default:b((()=>[(v(!0),k(U,null,S(V(M),(a=>(v(),_(V(Z),{key:a[V(q).key],class:D(V(c).be("panel","item")),value:a[V(q).key],disabled:a[V(q).disabled],"validate-event":!1},{default:b((()=>{var t;return[C(n,{option:null==(t=e.optionRender)?void 0:t.call(e,a)},null,8,["option"])]})),_:2},1032,["class","value","disabled"])))),128))])),_:1},8,["modelValue","onUpdate:modelValue","class"]),[[w,!V(R)&&!V(m)(e.data)]]),P(y("p",{class:D(V(c).be("panel","empty"))},B(V(R)?V(s)("el.transfer.noMatch"):V(s)("el.transfer.noData")),3),[[w,V(R)||V(m)(e.data)]])],2),V(F)?(v(),k("p",{key:0,class:D(V(c).be("panel","footer"))},[I(e.$slots,"default")],2)):j("v-if",!0)],2))}}),[["__file","transfer-panel.vue"]]);const me=c({name:"ElTransfer"});const ge=G(O(c({...me,props:se,emits:de,setup(e,{expose:a,emit:t}){const r=e,s=u(),{t:d}=f(),c=h("transfer"),{formItem:g}=q(),x=p({leftChecked:[],rightChecked:[]}),A=fe(r),{sourceData:_,targetData:E}=(e=>{const a=fe(e),t=o((()=>e.data.reduce(((e,t)=>(e[t[a.value.key]]=t)&&e),{})));return{sourceData:o((()=>e.data.filter((t=>!e.modelValue.includes(t[a.value.key]))))),targetData:o((()=>"original"===e.targetOrder?e.data.filter((t=>e.modelValue.includes(t[a.value.key]))):e.modelValue.reduce(((e,a)=>{const l=t.value[a];return l&&e.push(l),e}),[])))}})(r),{onSourceCheckedChange:T,onTargetCheckedChange:P}=((e,a)=>({onSourceCheckedChange:(t,l)=>{e.leftChecked=t,l&&a(re,t,l)},onTargetCheckedChange:(t,l)=>{e.rightChecked=t,l&&a(ne,t,l)}}))(x,t),{addToLeft:w,addToRight:U}=((e,a,t)=>{const r=fe(e),s=(e,a,r)=>{t(n,e),t(l,e,a,r)};return{addToLeft:()=>{const t=e.modelValue.slice();a.rightChecked.forEach((e=>{const a=t.indexOf(e);a>-1&&t.splice(a,1)})),s(t,"left",a.rightChecked)},addToRight:()=>{let t=e.modelValue.slice();const l=e.data.filter((t=>{const l=t[r.value.key];return a.leftChecked.includes(l)&&!e.modelValue.includes(l)})).map((e=>e[r.value.key]));t="unshift"===e.targetOrder?l.concat(t):t.concat(l),"original"===e.targetOrder&&(t=e.data.filter((e=>t.includes(e[r.value.key]))).map((e=>e[r.value.key]))),s(t,"right",a.leftChecked)}}})(r,x,t),S=M(),O=M(),G=o((()=>2===r.buttonTexts.length)),H=o((()=>r.titles[0]||d("el.transfer.titles.0"))),J=o((()=>r.titles[1]||d("el.transfer.titles.1"))),K=o((()=>r.filterPlaceholder||d("el.transfer.filterPlaceholder")));i((()=>r.modelValue),(()=>{var e;r.validateEvent&&(null==(e=null==g?void 0:g.validate)||e.call(g,"change").catch((e=>z())))}));const Y=o((()=>e=>r.renderContent?r.renderContent($,e):s.default?s.default({option:e}):$("span",e[A.value.label]||e[A.value.key])));return a({clearQuery:e=>{switch(e){case"left":S.value.query="";break;case"right":O.value.query=""}},leftPanel:S,rightPanel:O}),(e,a)=>(v(),k("div",{class:D(V(c).b())},[C(pe,{ref_key:"leftPanel",ref:S,data:V(_),"option-render":V(Y),placeholder:V(K),title:V(H),filterable:e.filterable,format:e.format,"filter-method":e.filterMethod,"default-checked":e.leftDefaultChecked,props:r.props,onCheckedChange:V(T)},{default:b((()=>[I(e.$slots,"left-footer")])),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),y("div",{class:D(V(c).e("buttons"))},[C(V(N),{type:"primary",class:D([V(c).e("button"),V(c).is("with-texts",V(G))]),disabled:V(m)(x.rightChecked),onClick:V(w)},{default:b((()=>[C(V(L),null,{default:b((()=>[C(V(R))])),_:1}),V(F)(e.buttonTexts[0])?j("v-if",!0):(v(),k("span",{key:0},B(e.buttonTexts[0]),1))])),_:1},8,["class","disabled","onClick"]),C(V(N),{type:"primary",class:D([V(c).e("button"),V(c).is("with-texts",V(G))]),disabled:V(m)(x.leftChecked),onClick:V(U)},{default:b((()=>[V(F)(e.buttonTexts[1])?j("v-if",!0):(v(),k("span",{key:0},B(e.buttonTexts[1]),1)),C(V(L),null,{default:b((()=>[C(V(Q))])),_:1})])),_:1},8,["class","disabled","onClick"])],2),C(pe,{ref_key:"rightPanel",ref:O,data:V(E),"option-render":V(Y),placeholder:V(K),filterable:e.filterable,format:e.format,"filter-method":e.filterMethod,title:V(J),"default-checked":e.rightDefaultChecked,props:r.props,onCheckedChange:V(P)},{default:b((()=>[I(e.$slots,"right-footer")])),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}}),[["__file","transfer.vue"]])),ve={class:"gva-form-box"},ke={class:"p-4 bg-white dark:bg-slate-900"},ye={class:"flex items-center gap-3"},Ce={class:"flex justify-end mt-2"},be={class:"flex justify-end mt-2"},xe={class:"flex justify-end"},Be={__name:"pubPlug",setup(e){const a=M(""),t=M([]),l=M([]),r=M([]),n=M([]),s=M(""),o=e=>{const a=[];return e.forEach((e=>{e.children?a.push(...o(e.children)):a.push(e)})),a},d=(e,a)=>a.meta.title.indexOf(e)>-1||a.component.indexOf(e)>-1,i=(e,a)=>a.description.indexOf(e)>-1||a.path.indexOf(e)>-1;(async()=>{const e=await H({page:1,pageSize:999});0===e.code&&(l.value=o(e.data.list));const a=await le();0===a.code&&(n.value=a.data.apis)})();const c=async()=>{J.confirm("请检查server下的/plugin/".concat(a.value,"/plugin.go是否已放开需要的 initialize.Api(ctx) 和 initialize.Menu(ctx)?"),"打包",{confirmButtonText:"打包",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=await ee({plugName:a.value});0===e.code&&K.success(e.msg)})).catch((()=>{K({type:"info",message:"关闭打包"})}))},u=()=>{s.value?0!==t.value.length?""!==a.value?J.confirm("点击后将会覆盖server下的/plugin/".concat(a.value,"/initialize/menu. 是否继续?"),"生成初始菜单",{confirmButtonText:"生成",cancelButtonText:"取消",type:"warning"}).then((()=>{const e={plugName:a.value,parentMenu:s.value,menus:t.value};ae(e)})).catch((()=>{K({type:"info",message:"关闭生成菜单"})})):K.error("请填写插件名"):K.error("请至少选择一个菜单"):K.error("请填写菜单组名")},f=()=>{0!==r.value.length?""!==a.value?J.confirm("点击后将会覆盖server下的/plugin/".concat(a.value,"/initialize/api. 是否继续?"),"生成初始API",{confirmButtonText:"生成",cancelButtonText:"取消",type:"warning"}).then((()=>{const e={plugName:a.value,apis:r.value};te(e),console.log(e)})).catch((()=>{K({type:"info",message:"关闭生成API"})})):K.error("请填写插件名"):K.error("请至少选择一个API")};return(e,o)=>{const h=T,p=ge,m=N,g=Y;return v(),k("div",ve,[y("div",ke,[C(X,{title:"目前只支持标准插件（通过插件模板生成的标准目录插件），非标准插件请自行打包"}),y("div",ye,[C(h,{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=e=>a.value=e),placeholder:"插件模板处填写的【插件名】"},null,8,["modelValue"])]),C(g,{class:"mt-2 text-center"},{default:b((()=>[C(X,{title:"穿梭框请只选择子级菜单即可"}),C(h,{modelValue:s.value,"onUpdate:modelValue":o[1]||(o[1]=e=>s.value=e),placeholder:"请输入菜单组名，例：公告管理",class:"mb-2"},null,8,["modelValue"]),C(p,{modelValue:t.value,"onUpdate:modelValue":o[2]||(o[2]=e=>t.value=e),props:{key:"ID"},class:"plugin-transfer",data:l.value,filterable:"","filter-method":d,"filter-placeholder":"请输入菜单名称/路径",titles:["可选菜单","使用菜单"],"button-texts":["移除","选中"]},{default:b((({option:e})=>[x(B(e.meta.title)+" "+B(e.component),1)])),_:1},8,["modelValue","data"]),y("div",Ce,[C(m,{type:"primary",onClick:u},{default:b((()=>[x(" 定义安装菜单 ")])),_:1})])])),_:1}),C(g,{class:"mt-2 text-center"},{default:b((()=>[C(p,{modelValue:r.value,"onUpdate:modelValue":o[3]||(o[3]=e=>r.value=e),props:{key:"ID"},class:"plugin-transfer",data:n.value,filterable:"","filter-method":i,"filter-placeholder":"请输入API描述/PATH",titles:["可选API","使用API"],"button-texts":["移除","选中"]},{default:b((({option:e})=>[x(B(e.description)+" "+B(e.path),1)])),_:1},8,["modelValue","data"]),y("div",be,[C(m,{type:"primary",onClick:f},{default:b((()=>[x(" 定义安装API ")])),_:1})])])),_:1})]),y("div",xe,[C(m,{type:"primary",onClick:c},{default:b((()=>[x(" 打包插件 ")])),_:1})])])}}};export{Be as default};
